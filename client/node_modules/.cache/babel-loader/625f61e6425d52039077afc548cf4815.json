{"ast":null,"code":"import _toConsumableArray from\"C:/Users/Lions/FullstackFinalProject/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _regeneratorRuntime from\"C:/Users/Lions/FullstackFinalProject/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Lions/FullstackFinalProject/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Lions/FullstackFinalProject/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{useParams,useNavigate}from'react-router-dom';import{supabase}from'../client';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PostDetail=function PostDetail(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),post=_useState2[0],setPost=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),comments=_useState4[0],setComments=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),comment=_useState6[0],setComment=_useState6[1];var _useParams=useParams(),id=_useParams.id;useEffect(function(){fetchPost();fetchComments();},[fetchPost,fetchComments]);// Include dependencies here\nvar fetchPost=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _yield$supabase$from$,data,error;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return supabase.from('criteria').select('*').eq('id',id).single();case 2:_yield$supabase$from$=_context.sent;data=_yield$supabase$from$.data;error=_yield$supabase$from$.error;if(!error){setPost(data);}case 6:case\"end\":return _context.stop();}}},_callee);}));return function fetchPost(){return _ref.apply(this,arguments);};}();var fetchComments=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var _yield$supabase$from$2,data,error;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return supabase.from('comments').select('*').eq('post_id',parseInt(id));case 2:_yield$supabase$from$2=_context2.sent;data=_yield$supabase$from$2.data;error=_yield$supabase$from$2.error;if(!error){setComments(data);}case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function fetchComments(){return _ref2.apply(this,arguments);};}();var handleCommentChange=function handleCommentChange(event){setComment(event.target.value);};var postComment=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var _yield$supabase$from$3,data,error;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return supabase.from('comments').insert([{post_id:parseInt(id),content:comment,created_at:new Date().toISOString()}]);case 2:_yield$supabase$from$3=_context3.sent;data=_yield$supabase$from$3.data;error=_yield$supabase$from$3.error;if(!error&&data&&data.length>0){setComments([].concat(_toConsumableArray(comments),[data[0]]));setComment('');alert('Comment added successfully!');}else if(error){alert('Failed to post comment. Please try again!');}case 6:case\"end\":return _context3.stop();}}},_callee3);}));return function postComment(){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{children:post?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:post.title}),/*#__PURE__*/_jsx(\"p\",{children:post.content}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Comments\"}),comments.map(function(comment,index){return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"p\",{children:comment.content})},index);}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Add a comment...\",value:comment,onChange:handleCommentChange}),/*#__PURE__*/_jsx(\"button\",{onClick:postComment,children:\"Post Comment\"})]})]})]}):/*#__PURE__*/_jsx(\"p\",{children:\"Loading post details...\"})});};export default PostDetail;","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","supabase","PostDetail","post","setPost","comments","setComments","comment","setComment","id","fetchPost","fetchComments","from","select","eq","single","data","error","parseInt","handleCommentChange","event","target","value","postComment","insert","post_id","content","created_at","Date","toISOString","length","alert","title","map","index"],"sources":["C:/Users/Lions/FullstackFinalProject/client/src/components/PostDetail.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { supabase } from '../client';\r\n\r\nconst PostDetail = () => {\r\n    const [post, setPost] = useState(null);\r\n    const [comments, setComments] = useState([]);\r\n    const [comment, setComment] = useState('');\r\n    const { id } = useParams();\r\n\r\n\r\n    useEffect(() => {\r\n        fetchPost();\r\n        fetchComments();\r\n      }, [fetchPost, fetchComments]); // Include dependencies here\r\n      \r\n\r\n    const fetchPost = async () => {\r\n        const { data, error } = await supabase\r\n            .from('criteria')\r\n            .select('*')\r\n            .eq('id', id)\r\n            .single();\r\n\r\n        if (!error) {\r\n            setPost(data);\r\n        }\r\n    };\r\n\r\n    const fetchComments = async () => {\r\n        const { data, error } = await supabase\r\n            .from('comments')\r\n            .select('*')\r\n            .eq('post_id', parseInt(id));\r\n\r\n        if (!error) {\r\n            setComments(data);\r\n        }\r\n    };\r\n\r\n    const handleCommentChange = (event) => {\r\n        setComment(event.target.value);\r\n    };\r\n\r\n    const postComment = async () => {\r\n        const { data, error } = await supabase\r\n            .from('comments')\r\n            .insert([\r\n                {\r\n                    post_id: parseInt(id),\r\n                    content: comment,\r\n                    created_at: new Date().toISOString()\r\n                }\r\n            ]);\r\n\r\n        if (!error && data && data.length > 0) {\r\n            setComments([...comments, data[0]]);\r\n            setComment('');\r\n            alert('Comment added successfully!');\r\n        } else if (error) {\r\n            alert('Failed to post comment. Please try again!');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div>\r\n            {post ? (\r\n                <div>\r\n                    <h1>{post.title}</h1>\r\n                    <p>{post.content}</p>\r\n                    <div>\r\n                        <h2>Comments</h2>\r\n                        {comments.map((comment, index) => (\r\n                            <div key={index}>\r\n                                <p>{comment.content}</p>\r\n                            </div>\r\n                        ))}\r\n                        <div>\r\n                            <input\r\n                                type=\"text\"\r\n                                placeholder=\"Add a comment...\"\r\n                                value={comment}\r\n                                onChange={handleCommentChange}\r\n                            />\r\n                            <button onClick={postComment}>Post Comment</button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            ) : (\r\n                <p>Loading post details...</p>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default PostDetail;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}